<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gobblet Gobblers - Multiplayer</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <section id="homeScreen">
      <h1>Gobblet Gobblers</h1>
      <div class="home-panel">
        <input id="roomInput" placeholder="ルーム名を入力" />
        <input id="homeNameInput" placeholder="プレイヤー名を入力" />
        <button id="createRoomBtn">ルームに入室 / 作成</button>
        <button id="homeSettingsBtn" class="secondary">⚙️ 設定</button>
      </div>
    </section>

    <section id="gameScreen" style="display:none;">
      <header>
      <h1>Gobblet Gobblers</h1>
      <div class="controls">
        <input id="nameInput" placeholder="あなたの名前" />
        <button id="settingsBtn" class="secondary">⚙️ 設定</button>
      </div>
    </header>

    <main>
      <section class="board-wrap"></section>
        <div id="turnCutIn" class="cutin-overlay hidden">
          <div class="cutin-content">
          <h2 id="cutinText"></h2>
          </div>
        </div>
        
      <div id="cheerLayer"></div>


      <aside class="panel">
        <div class="status">
          <div>あなた: <span id="meLabel">未割当</span></div>
          <div>ターン: <span id="turnLabel">—</span></div>
          <div>状態: <span id="gameStateLabel">待機中</span></div>
          <div>Room: <span id="currentRoomLabel">-</span></div>
        </div>

        <div class="hand">
          <div id="handContainer" class="hand-row"></div>
        </div>

        <div class="log" id="log"></div>
        <div class="chat-box">
          <div id="chatMessages" class="chat-messages"></div>
          <div class="chat-input-row">
            <input id="chatInput" placeholder="応援コメントを送る..." />
            <button id="chatSendBtn">送信</button>
          </div>
        </div>
      </aside>
    </main>
  </section>
</div>

<div id="modalOverlay" class="modal-overlay hidden">
    <div class="modal-window">
      <div class="modal-header">
        <h2>設定</h2>
        <button id="closeModalBtn" class="close-btn">×</button>
      </div>
      
      <div class="modal-tabs">
        <button class="tab-btn active" data-tab="tab-env">環境設定</button>
        <button class="tab-btn" data-tab="tab-control">ゲーム操作</button>
        <button class="tab-btn" data-tab="tab-rule">ヘルプ</button>
      </div>

      <div class="modal-content">
        <div id="tab-env" class="tab-pane active">
          <div class="setting-item">
            <label>BGM音量</label>
            <input id="bgmVolumeSlider" type="range" min="0" max="100" value="30">
          </div>
          <div class="setting-item">
            <label>SE音量</label>
            <input id="seVolumeSlider" type="range" min="0" max="100" value="50">
          </div>
          <div class="setting-item">
            <label>移動可能マスをハイライト</label>
            <button id="toggleHighlightBtn" class="toggle-btn on">ON</button>
          </div>
        </div>

        <div id="tab-control" class="tab-pane">
          <p>対戦中の操作</p>
          <button id="modalLeaveBtn" class="action-btn danger">退出する</button>
        </div>

        <div id="tab-rule" class="tab-pane">
          <h3>ルール概要</h3>
          <ul>
            <li>自分のゴブラー駒3個を、相手よりも先に縦か横か斜めの1列に並べられた人が勝ちです！</li>
            <li>自分が駒を持ち上げたとき、もしその下にあった駒の色で3個1列が揃ったなら、ただちにその色の人が勝ちです。</li>
            <li>手駒を置くか、盤上の駒を移動できる。</li>
            <li>「大」は「中・小」に、「中」は「小」に被せることができる。</li>
            <li>被せている駒を動かすと下の駒が現れる。</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

<div id="resultOverlay" class="result-overlay hidden">
  <div class="result-content">
    <h1 id="resultTitle">WIN!</h1>
    <p id="resultMessage">おめでとうございます！</p>
    
    <div id="playerActions" class="result-actions">
      <button id="btnRematch" class="result-btn btn-rematch">再戦する</button>
      <button id="btnSpectate" class="result-btn btn-spectate">観戦に回る</button>
      <button id="btnLeave" class="result-btn btn-leave">部屋を抜ける</button>
    </div>
    
    <div id="spectatorActions" class="result-actions hidden">
        <button id="resultCloseBtn" class="result-btn secondary-btn">閉じる</button>
    </div>

    <div id="resultWaitMsg" class="result-wait-msg hidden">相手の選択を待っています...</div>

  </div>
</div>

<script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.160/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160/examples/jsm/",
      "canvas-confetti": "https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.module.mjs"
    }
  }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script type="module" src="client.js"></script>

</body>
</html>